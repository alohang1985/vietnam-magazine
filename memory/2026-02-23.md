# 2026-02-23 — 작업 로그 (자동 저장 용)

- 시간: 2026-02-23 (Asia/Saigon)
- 요약: 오늘 피디님과 함께 깃허브 리포지토리(vietnam-magazine)에서 여러 개발 작업을 수행하고 배포용 API 및 관리자 UI를 추가/수정함.

주요 변경 사항 (durable):
- 자동 포스팅 스케줄 확인
  - .github/workflows/auto-post.yml의 cron: '0 1 * * *', '0 6 * * *', '0 12 * * *' (UTC)
  - 베트남 시간(UTC+7): 08:00, 13:00, 19:00

- Telegram bot 변경
  - 파일: telegram-bot/bot.js
  - generatePost 프롬프트를 사용자 제공 콘텐츠를 분석해 재작성하도록 교체

- 관리자 UI 및 API 추가/수정
  - 프론트엔드 관리자 페이지 추가: apps/frontend-next/app/admin/page.tsx
    - 포스트 생성, 수정, 삭제 UI
    - 비밀번호 보호: /api/admin/auth 서버측 검증 (ADMIN_PASSWORD env)
    - 포스트 목록 조회, 수정(PUT), 삭제(DELETE)
    - 메인 이미지 URL 입력창, Unsplash 검색 삽입, 파일 업로드 삽입
    - 생성/수정 시 hero_image 전송 포함
    - authChecked에 따라 자동으로 포스트 목록 로드
  - API 라우트 추가/수정:
    - POST /api/admin/post -> apps/frontend-next/app/api/admin/post/route.ts
      - GEMINI_API_KEY, STRAPI_API_TOKEN, STRAPI_URL (또는 NEXT_PUBLIC_CMS_URL) 필요
      - 누락 env에 대해 상세 로그(missing list)를 반환하도록 수정
    - POST /api/admin/auth -> apps/frontend-next/app/api/admin/auth/route.ts
      - ADMIN_PASSWORD 서버 env와 비교 (서버사이드 검증)
    - GET /api/admin/posts -> apps/frontend-next/app/api/admin/posts/route.ts
      - Strapi에서 pagination[limit]=50, sort=publishedAt:desc로 불러옴
    - PUT/DELETE /api/admin/posts/[id] -> apps/frontend-next/app/api/admin/posts/[id]/route.ts
      - 업데이트 페이로드 타입 안전성 개선 (TypeScript 타입 추가)
    - GET /api/admin/unsplash -> apps/frontend-next/app/api/admin/unsplash/route.ts
      - UNSPLASH_ACCESS_KEY 사용하여 Unsplash 검색 5개 반환
    - POST /api/admin/upload -> apps/frontend-next/app/api/admin/upload/route.ts
      - multipart 파일을 Strapi 업로드로 포워딩

- 포스트 상세/홈페이지 디자인 수정
  - apps/frontend-next/app/page.tsx: 홈 페이지 재디자인(흰배경, 틸(#2a9d8f), 다크네이비(#1a1a2e), 카드 그리드 3열)
  - apps/frontend-next/app/posts/[slug]/page.tsx: 포스트 상세 재디자인(히어로 이미지 500px, 제목 스타일, 본문 최대 720px)
  - 서버사이드에서 UNSPLASH_ACCESS_KEY로 이미지 2장 불러와 본문 중간에 삽입하는 기능 추가

- 커밋/푸시
  - 위 변경 사항들을 여러 커밋으로 로컬에서 커밋 후 원격 main에 푸시함.

주의/권장 (action items):
- 배포 환경에 다음 env를 설정해야 함: GEMINI_API_KEY, STRAPI_API_TOKEN, STRAPI_URL (또는 NEXT_PUBLIC_CMS_URL), UNSPLASH_ACCESS_KEY, ADMIN_PASSWORD
- 인증은 현재 단순 비밀번호 비교이고 세션 유지가 없음. 세션/쿠키 기반 인증이 필요하면 구현 권장.
- Unsplash 사용 시 저작자 표기 및 약관 확인 권장.

메모 작성자: JARVIS (OpenClaw 에이전트)
